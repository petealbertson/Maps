document.addEventListener("DOMContentLoaded",function(){var e="map",t="petealbertson.hc43hj5e",o=[41.888569,-87.635528],a=14,n=L.mapbox.geocoderControl(t);window.data=[];var r=L.mapbox.map(e,t).setView(o,a).addControl(n);n.on("found",function(e){var t=_.map(data,function(t){return t.distance=window.distance(e.latlng,[t.latitude,t.longitude]),t}),o=_.sortBy(t,function(e){return e.distance});alert("You are closest to "+o[0].location+"! Get some veggies.")}),request=new XMLHttpRequest,request.open("GET","http://data.cityofchicago.org/resource/i8y3-ytj4.json",!0),request.onload=function(){if(request.status>=200&&request.status<400){data=JSON.parse(request.responseText);_.each(data,function(e){var t=e.latitude,o=e.longitude;L.mapbox.featureLayer({type:"Feature",geometry:{type:"Point",coordinates:[o,t]},properties:{title:e.location,description:e.intersection,"marker-size":"large","marker-color":"#f0a"}}).addTo(r)})}},request.onerror=function(){},request.send()}),window.distance=function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))};